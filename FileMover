-- Ask user to choose destination folder (e.g., on external drive)
set destinationAlias to (choose folder with prompt "Select the destination folder (e.g. NewLocation on external drive):")

-- Handler: return most recent file (by modification date) in a Finder folder alias
on getMostRecentFileFromFolder(folderAlias)
	tell application "Finder"
		try
			set fileList to every file of folder folderAlias
		on error
			set fileList to {}
		end try
		if (count of fileList) is 0 then return missing value
		set recentFile to item 1 of fileList
		set recentDate to (modification date of recentFile)
		repeat with f in fileList
			set d to (modification date of f)
			if d > recentDate then
				set recentDate to d
				set recentFile to f
			end if
		end repeat
		return recentFile
	end tell
end getMostRecentFileFromFolder

-- Main logic
tell application "Finder"
	set downloadsFolder to (path to downloads folder) as alias
	set documentsFolder to (path to documents folder) as alias
	
	set recentDownload to my getMostRecentFileFromFolder(downloadsFolder)
	set recentDocument to my getMostRecentFileFromFolder(documentsFolder)
	
	if recentDownload is missing value and recentDocument is missing value then
		display dialog "No files found in Downloads or Documents." buttons {"OK"} default button 1
		return
	else if recentDownload is missing value then
		set fileToMove to recentDocument
	else if recentDocument is missing value then
		set fileToMove to recentDownload
	else
		if (modification date of recentDownload) > (modification date of recentDocument) then
			set fileToMove to recentDownload
		else
			set fileToMove to recentDocument
		end if
	end if
	
	set fileName to name of fileToMove
	if exists file fileName of destinationAlias then
		display dialog "File '" & fileName & "' already exists in destination. Skipping move." buttons {"OK"} default button 1
	else
		-- Copy to external drive
		duplicate fileToMove to folder destinationAlias
		-- Remove original
		delete fileToMove
		display notification "Moved " & fileName & " â†’ " & (POSIX path of (destinationAlias as alias))
	end if
end tell
